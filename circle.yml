machine:
  node:
    version: 6.9.1

deployment:
  dev:
    branch: MON-2233
    commands:
      - heroku maintenance:on --app oi-contact-organiser-dev
      - git fetch origin --unshallow
      - git push --force git@heroku.com:oi-contact-organiser-dev.git $CIRCLE_SHA1:refs/heads/master
      - heroku maintenance:off --app oi-contact-organiser-dev

  staging:
    branch: test
    commands:
      - heroku maintenance:on --app oi-contact-organiser-test
      - git fetch origin --unshallow
      - git push git@heroku.com:oi-contact-organiser-test.git $CIRCLE_SHA1:refs/heads/master
      - heroku maintenance:off --app oi-contact-organiser-test

  production:
    branch: master
    commands:
      - heroku maintenance:on --app oi-contact-organiser
      - git fetch origin --unshallow
      - git push git@heroku.com:oi-contact-organiser.git $CIRCLE_SHA1:refs/heads/master
      - heroku maintenance:off --app oi-contact-organiser

test:
  override:
    - touch no-tests
